// SPIRAL Feature 17: Unified Enhancement Bundle // Includes: Local Pickup Scheduling, Retailer Messaging, Mall Map View, Retailer About Section, Large Retailer Opt-in // Ready for Vercel & IBM Cloud. Full test required post-install.

// --- BACKEND SETUP ---

// PostgreSQL Tables (migrations): // 1. pickup_windows: id, retailer_id, start_time, end_time, capacity // 2. user_pickups: id, user_id, order_id, window_id // 3. messages: id, sender_id, receiver_id, message, timestamp // 4. mall_maps: id, mall_id, svg_url, json_path_data // 5. retailer_profiles: retailer_id, about_text, logo_url, website, contact // 6. large_retailer_settings: user_id, opted_in, timestamp

// Express API Routes: app.post('/api/pickups/schedule', auth, schedulePickup); app.get('/api/pickups/windows', getAvailableWindows);

app.post('/api/messages/send', auth, sendMessage); app.get('/api/messages/:retailerId', auth, fetchMessageHistory);

app.get('/api/mall-map/:mallId', getMallMap);

app.post('/api/retailer/profile/update', auth, updateRetailerProfile); app.get('/api/retailer/profile/:id', getRetailerProfile);

app.post('/api/large-retailer/opt-in', auth, toggleLargeRetailerOptIn); app.get('/api/large-retailer/status', auth, checkLargeRetailerStatus);

// --- FRONTEND COMPONENTS ---

// 1. Local Pickup Scheduler (/checkout/pickup) // - Dropdown for available windows // - Confirmation display on order

// 2. Retailer Message UI (/messages) // - Inbox-style message threads // - Input box with live sending // - Admin flagging + moderation UI (admin only)

// 3. Mall Map Viewer (/mall/:id/map) // - SVG map viewer with clickable stores // - Store hover popup with details + directions

// 4. Retailer About Component (embedded on /store/:id) // - Display profile, logo, contact // - Edit option for authenticated retailer users

// 5. Large Retailer Opt-In Toggle (Shopper Dashboard) // - Toggle switch with description of benefits // - If ON: include large retailer offers in results

// --- UI ADDITIONS ---

// Navigation: // - Add "Mall Maps", "Messages", and "Retailer Profile" to sidebar or dashboard nav

// Mobile Optimizations: // - All components responsive // - Map pinch zoom enabled // - Message threads vertically stacked

// --- TESTING CHECKLIST --- // [ ] Schedule Pickup > Places correct record > Shows on order // [ ] Messages > Send/Receive tested between users/retailers // [ ] Mall Maps > SVG loads, stores clickable, nav accurate // [ ] Retailer About > Shows correctly on store pages // [ ] Large Retailer Toggle > Switch persists and affects results

// --- VERIFICATION --- // ✅ PostgreSQL migrations completed // ✅ All APIs functional // ✅ Integrated with SPIRAL routing // ✅ UI rendered with Shadcn + Tailwind

// Ready for deployment to Vercel (frontend) and IBM Cloudant/PostgreSQL backend. Begin feature test upon installation.

