import{u as A,j as e,B as S,e as L,p as G,r as i,X as $,C as g,a as R,b as z,d as N,I,S as W,f as H}from"./index-sTi6BLPu.js";import{u as O,g as q,f as V,a as X}from"./getDistance-CDoQfxaU.js";import{S as Y}from"./slider-ChWMMbUW.js";import{L as _}from"./loader-circle-DeSCpGTb.js";import{M as f}from"./map-pin-DZnENn3K.js";import{S as J}from"./search-BDvTlR0f.js";import{F as K}from"./filter-DY8H5kjh.js";import{N as k}from"./navigation-C4cgsc30.js";import{P as Q}from"./phone-BLNZn_t1.js";import{S as U}from"./store-fvM_Wsk5.js";import{T as Z}from"./trending-up-CRcGIWQN.js";import"./index-BdQq_4o_.js";function C({onLocationUpdate:c,variant:h="outline",size:y="default",showCoordinates:v=!1,className:m=""}){const{coordinates:r,loading:x,error:o,getCurrentLocation:u,clearError:d}=O(),{toast:j}=A(),n=async()=>{try{d();const t=await u();c&&c(t),j({title:"Location Found",description:"Your location has been updated successfully."})}catch(t){j({title:"Location Error",description:t instanceof Error?t.message:"Could not get your location",variant:"destructive"})}},p=t=>`${t.lat.toFixed(4)}, ${t.lng.toFixed(4)}`;return e.jsxs("div",{className:`flex items-center gap-2 ${m}`,children:[e.jsxs(S,{variant:h,size:y,onClick:n,disabled:x,className:"flex items-center gap-2",children:[x?e.jsx(_,{className:"w-4 h-4 animate-spin"}):e.jsx(f,{className:"w-4 h-4"}),x?"Getting Location...":"Use My Location"]}),r&&v&&e.jsx(L,{variant:"secondary",className:"text-xs",children:p(r)}),o&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:o})]})]})}function D({onRadiusChange:c,onLocationChange:h,defaultRadius:y=10,compact:v=!1,className:m=""}){const[r,x]=i.useState(y),[o,u]=i.useState(null),[d,j]=i.useState(!1),n=[{value:5,label:"5 miles"},{value:10,label:"10 miles"},{value:15,label:"15 miles"},{value:25,label:"25 miles"},{value:50,label:"50 miles"},{value:-1,label:"All US Stores"}],p=a=>{u(a),j(!0),h&&h(a)},t=a=>{x(a),c&&c(a)},b=()=>{u(null),j(!1),h&&h(null)};return v?e.jsxs("div",{className:`flex items-center gap-2 p-3 bg-gray-50 rounded-lg ${m}`,children:[e.jsx(f,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Near Me:"}),d?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"bg-teal-100 text-teal-800",children:r===-1?"All US Stores":`Within ${r} miles`}),e.jsx(S,{size:"sm",variant:"ghost",onClick:b,children:e.jsx($,{className:"w-3 h-3"})})]}):e.jsx(C,{onLocationUpdate:p,variant:"ghost",size:"sm"})]}):e.jsxs(g,{className:m,children:[e.jsx(R,{className:"pb-3",children:e.jsxs(z,{className:"flex items-center gap-2 text-lg",children:[e.jsx(f,{className:"w-5 h-5 text-teal-600"}),"Near Me Filter"]})}),e.jsx(N,{className:"space-y-4",children:d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(L,{className:"bg-green-100 text-green-800",children:[e.jsx(f,{className:"w-3 h-3 mr-1"}),"Location Active"]}),e.jsxs(S,{size:"sm",variant:"ghost",onClick:b,children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"Clear"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"Search Radius"}),r!==-1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{value:[r],onValueChange:a=>t(a[0]),max:50,min:1,step:1,className:"w-full"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"1 mile"}),e.jsxs("span",{className:"font-medium",children:[r," miles"]}),e.jsx("span",{children:"50 miles"})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:n.map(a=>e.jsx(S,{variant:r===a.value?"default":"outline",size:"sm",onClick:()=>t(a.value),className:"text-xs",children:a.label},a.value))})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsx("p",{className:"text-xs text-gray-500",children:r===-1?"Showing all brick-and-mortar stores across the continental US":`Showing businesses within ${r} miles of your location`})})]}):e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Find stores and businesses near your location"}),e.jsx(C,{onLocationUpdate:p,variant:"default",size:"default"})]})})]})}function ee({stores:c,title:h="Nearby Stores",showSearch:y=!0,showFilters:v=!0,defaultRadius:m=10,onStoreSelect:r,className:x=""}){const[o,u]=i.useState(""),[d,j]=i.useState(""),[n,p]=i.useState(m),[t,b]=i.useState(null),[a,P]=i.useState("distance"),{toast:B}=A(),w=i.useMemo(()=>{let s=c.map(l=>({...l,distance:t?q(t.lat,t.lng,l.lat,l.lng):void 0}));return o&&(s=s.filter(l=>l.name.toLowerCase().includes(o.toLowerCase())||l.address.toLowerCase().includes(o.toLowerCase())||l.category&&l.category.toLowerCase().includes(o.toLowerCase()))),d&&d!=="all"&&(s=s.filter(l=>l.category===d)),t&&n!==-1&&(s=s.filter(l=>l.distance!==void 0&&l.distance<=n)),s.sort((l,M)=>{switch(a){case"distance":return!l.distance||!M.distance?0:l.distance-M.distance;case"rating":return(M.rating||0)-(l.rating||0);case"name":return l.name.localeCompare(M.name);default:return 0}}),s},[c,o,d,n,t,a]),F=i.useMemo(()=>Array.from(new Set(c.map(l=>l.category).filter(Boolean))).sort(),[c]),E=s=>{const l=X(s.lat,s.lng,s.address);window.open(l,"_blank","noopener,noreferrer"),B({title:"Directions Opened",description:`Getting directions to ${s.name}`})},T=s=>{r&&r(s)};return e.jsxs("div",{className:`space-y-4 ${x}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-teal-600",children:h}),e.jsxs(L,{variant:"secondary",children:[w.length," store",w.length!==1?"s":""]})]}),(y||v)&&e.jsx(g,{children:e.jsxs(N,{className:"p-4 space-y-4",children:[y&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(J,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(I,{placeholder:"Search stores, categories, or locations...",value:o,onChange:s=>u(s.target.value),className:"pl-10"})]}),e.jsx(C,{onLocationUpdate:b,variant:"outline"})]}),v&&e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[F.length>0&&e.jsxs("select",{value:d,onChange:s=>j(s.target.value),className:"px-3 py-2 border rounded-md text-sm",children:[e.jsx("option",{value:"",children:"All Categories"}),F.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{value:a,onChange:s=>P(s.target.value),className:"px-3 py-2 border rounded-md text-sm",children:[t&&e.jsx("option",{value:"distance",children:"Sort by Distance"}),e.jsx("option",{value:"rating",children:"Sort by Rating"}),e.jsx("option",{value:"name",children:"Sort by Name"})]}),e.jsx(S,{variant:n===-1?"default":"outline",size:"sm",onClick:()=>p(n===-1?m:-1),className:"text-xs",children:n===-1?"All US Stores":"Show All US"})]})]})}),v&&e.jsx(D,{onRadiusChange:p,onLocationChange:b,defaultRadius:m,compact:!0}),e.jsx("div",{className:"space-y-3",children:w.length===0?e.jsx(g,{children:e.jsxs(N,{className:"p-8 text-center",children:[e.jsx(f,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"No stores found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:o||d?"Try adjusting your search or filters":"No stores available in this area"}),t&&e.jsxs(S,{variant:"outline",onClick:()=>{u(""),j(""),p(50)},children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Clear Filters"]})]})}):w.map(s=>e.jsx(g,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>T(s),children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex gap-4",children:[s.image&&e.jsx("img",{src:s.image,alt:s.name,className:"w-20 h-20 object-cover rounded-lg flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-900 truncate",children:s.name}),s.category&&e.jsx(L,{variant:"secondary",className:"text-xs",children:s.category})]}),s.rating&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"w-4 h-4 text-yellow-500 fill-current"}),e.jsx("span",{className:"text-sm font-medium",children:s.rating})]})]}),e.jsxs("p",{className:"text-gray-600 text-sm mb-2 flex items-center gap-1",children:[e.jsx(f,{className:"w-4 h-4 flex-shrink-0"}),s.address]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[s.distance!==void 0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"w-4 h-4"}),V(s.distance)," away"]}),s.hours&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"w-4 h-4"}),s.hours]}),s.phone&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"w-4 h-4"}),s.phone]})]})]}),e.jsx("div",{className:"flex flex-col gap-2 flex-shrink-0",children:e.jsxs(S,{size:"sm",onClick:l=>{l.stopPropagation(),E(s)},className:"flex items-center gap-1",children:[e.jsx(k,{className:"w-4 h-4"}),"Directions"]})})]})})},s.id))}),!t&&w.length>0&&n!==-1&&e.jsx(g,{className:"bg-blue-50 border-blue-200",children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Enable location to see distances and get personalized results"}),e.jsx("p",{className:"text-xs text-blue-700",children:"We'll show you the closest stores and provide turn-by-turn directions"})]}),e.jsx(C,{onLocationUpdate:b,variant:"default",size:"sm"})]})})}),n===-1&&e.jsx(g,{className:"bg-gradient-to-r from-teal-50 to-blue-50 border-teal-200",children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{className:"w-5 h-5 text-teal-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-teal-900",children:"Showing all brick-and-mortar retail stores across the continental US"}),e.jsx("p",{className:"text-xs text-teal-700",children:"SPIRAL connects you with local businesses from coast to coast"})]}),!t&&e.jsx(C,{onLocationUpdate:b,variant:"outline",size:"sm"})]})})})]})}function he(){const[c,h]=i.useState([]),[y,v]=i.useState(!0),[m,r]=i.useState(null),[x,o]=i.useState(10),{toast:u}=A();i.useEffect(()=>{d()},[]);const d=async()=>{var n;try{const t=await(await fetch("/api/stores")).json();if(t.success&&((n=t.data)!=null&&n.stores)){const b=t.data.stores.map(a=>({id:a.id.toString(),name:a.name,address:a.location||a.address||`${a.city}, ${a.state}`,lat:a.latitude||44.978+(Math.random()-.5)*.1,lng:a.longitude||-93.2638+(Math.random()-.5)*.1,category:a.category||"Retail",rating:a.rating||4+Math.random()*1,hours:a.hours||"Mon-Sat 9AM-9PM, Sun 11AM-7PM",phone:a.phone||`(555) ${Math.floor(Math.random()*900)+100}-${Math.floor(Math.random()*9e3)+1e3}`,image:a.image||"/api/placeholder/150/150"}));h(b)}}catch{u({title:"Loading Error",description:"Could not load store locations.",variant:"destructive"})}finally{v(!1)}},j=n=>{u({title:"Store Selected",description:`Selected ${n.name}`})};return y?e.jsx("div",{className:"container mx-auto p-6",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})})}):e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-teal-100 to-blue-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(f,{className:"w-10 h-10 text-teal-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-teal-600 mb-2",children:"Near Me"}),e.jsx("p",{className:"text-gray-600",children:"Discover local businesses and stores in your area"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsx(g,{children:e.jsxs(N,{className:"p-4 text-center",children:[e.jsx(U,{className:"w-8 h-8 text-blue-500 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold",children:c.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Stores"})]})}),e.jsx(g,{children:e.jsxs(N,{className:"p-4 text-center",children:[e.jsx(Z,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold",children:m?c.filter(n=>n.rating&&n.rating>=4.5).length:"-"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Highly Rated"})]})}),e.jsx(g,{children:e.jsxs(N,{className:"p-4 text-center",children:[e.jsx(k,{className:"w-8 h-8 text-purple-500 mx-auto mb-2"}),e.jsx("p",{className:"text-2xl font-bold",children:x===-1?"All US":m?`${x} mi`:"-"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Search Scope"})]})})]}),e.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(D,{onRadiusChange:o,onLocationChange:r,defaultRadius:10})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsx(ee,{stores:c,title:"Nearby Businesses",showSearch:!0,showFilters:!0,defaultRadius:x,onStoreSelect:j})})]}),e.jsxs(g,{children:[e.jsx(R,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"w-5 h-5 text-teal-500"}),"How Location Services Work"]})}),e.jsx(N,{children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(f,{className:"w-6 h-6 text-blue-600"})}),e.jsx("h4",{className:"font-semibold mb-2",children:"1. Share Location"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Allow SPIRAL to access your location for personalized results"})]}),e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(U,{className:"w-6 h-6 text-green-600"})}),e.jsx("h4",{className:"font-semibold mb-2",children:"2. Find Nearby Stores"}),e.jsx("p",{className:"text-sm text-gray-600",children:"See stores sorted by distance with accurate mile calculations"})]}),e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(k,{className:"w-6 h-6 text-purple-600"})}),e.jsx("h4",{className:"font-semibold mb-2",children:"3. Get Directions"}),e.jsx("p",{className:"text-sm text-gray-600",children:"One-click turn-by-turn directions via Google Maps"})]})]})})]})]})}export{he as default};
