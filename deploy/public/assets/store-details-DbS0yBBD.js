import{u as y,r as $,j as e,C as u,a as j,b as w,q as C,d as f,B as l,aX as U,e as q,S as G,f as D}from"./index-sTi6BLPu.js";import{u as b}from"./useQuery-4av79AcX.js";import{M as N}from"./map-pin-DZnENn3K.js";import{N as k}from"./navigation-C4cgsc30.js";import{E as L}from"./external-link-C3qeqPCI.js";import{P as A}from"./phone-BLNZn_t1.js";function I({store:a,className:x=""}){const{toast:t}=y(),[h,p]=$.useState(!1),m=(i,o)=>i&&o?`https://www.google.com/maps/dir/?api=1&destination=${i},${o}`:`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(a.address)}`,s=()=>{if(p(!0),navigator.geolocation)navigator.geolocation.getCurrentPosition(i=>{const o=i.coords.latitude,n=i.coords.longitude;let c;if(a.lat&&a.lng)c=`https://www.google.com/maps/dir/${o},${n}/${a.lat},${a.lng}`;else{const r=encodeURIComponent(a.address);c=`https://www.google.com/maps/dir/${o},${n}/${r}`}window.open(c,"_blank"),p(!1),t({title:"Directions opened",description:`Google Maps directions to ${a.name} opened in new tab`})},i=>{p(!1),console.error("Geolocation error:",i);const o=m(a.lat,a.lng);window.open(o,"_blank"),t({title:"Directions opened",description:"Location access denied. Basic directions opened.",variant:"default"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5});else{p(!1);const i=m(a.lat,a.lng);window.open(i,"_blank"),t({title:"Directions opened",description:"Location services not available. Basic directions opened."})}},g=()=>{let i;a.lat&&a.lng?i=`https://www.google.com/maps/search/?api=1&query=${a.lat},${a.lng}`:i=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(`${a.name} ${a.address}`)}`,window.open(i,"_blank"),t({title:"Location opened",description:`${a.name} location opened in Google Maps`})};return e.jsxs(u,{className:x,children:[e.jsxs(j,{className:"pb-3",children:[e.jsxs(w,{className:"flex items-center gap-2 text-lg",children:[e.jsx(N,{className:"h-5 w-5 text-blue-600"}),"Get Directions"]}),e.jsxs(C,{children:["Navigate to ",a.name]})]}),e.jsxs(f,{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:[e.jsx("p",{className:"font-medium",children:a.name}),e.jsx("p",{children:a.address}),a.phone&&e.jsx("p",{children:a.phone})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{onClick:s,disabled:h,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),h?"Getting Location...":"Get Directions"]}),e.jsxs(l,{variant:"outline",onClick:g,className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"View on Maps"]})]}),a.rating&&e.jsx("div",{className:"text-sm text-gray-500 pt-2 border-t",children:e.jsxs("span",{className:"inline-flex items-center",children:["⭐ ",a.rating," rating",a.category&&e.jsxs("span",{className:"ml-2 text-gray-400",children:["• ",a.category]})]})})]})]})}function z(){var o;const{storeId:a}=U(),{toast:x}=y();$.useState(null);const{data:t,isLoading:h,error:p}=b({queryKey:["/api/maps/store-location",a],queryFn:()=>fetch(`/api/maps/store-location/${a}`).then(n=>n.json()),enabled:!!a}),{data:m}=b({queryKey:["/api/stores",a],queryFn:()=>fetch(`/api/stores/${a}`).then(n=>n.json()),enabled:!!a&&(!t||!t.success)}),s=t!=null&&t.success?t.data.store:(o=m==null?void 0:m.data)==null?void 0:o.store,g=(n,c,r)=>{let d;if(n&&c)d=`https://www.google.com/maps/search/?api=1&query=${n},${c}`;else if(r)d=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(r)}`;else{x({title:"Location unavailable",description:"No location data found for this store",variant:"destructive"});return}window.open(d,"_blank")},i=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(n=>{const c=n.coords.latitude,r=n.coords.longitude;let d;if(s!=null&&s.lat&&(s!=null&&s.lng))d=`https://www.google.com/maps/dir/${c},${r}/${s.lat},${s.lng}`;else if(s!=null&&s.address){const v=encodeURIComponent(s.address);d=`https://www.google.com/maps/dir/${c},${r}/${v}`}else{x({title:"Cannot get directions",description:"Store location data unavailable",variant:"destructive"});return}window.open(d,"_blank"),x({title:"Directions opened",description:`Google Maps directions to ${s.name}`})},()=>{let n;s!=null&&s.lat&&(s!=null&&s.lng)?n=`https://www.google.com/maps/dir/?api=1&destination=${s.lat},${s.lng}`:s!=null&&s.address&&(n=`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(s.address)}`),n&&window.open(n,"_blank")})};return h?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"})]})})}):s?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{children:s.address})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mt-1",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("a",{href:`tel:${s.phone}`,className:"hover:text-blue-600",children:s.phone})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(q,{variant:s.isVerified?"default":"secondary",children:s.category}),s.rating&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-4 w-4 text-yellow-500 fill-current"}),e.jsx("span",{className:"font-semibold",children:s.rating})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(w,{children:"Store Information"})}),e.jsxs(f,{className:"space-y-4",children:[s.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"About"}),e.jsx("p",{className:"text-gray-600",children:s.description})]}),s.hours&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"Hours"]}),e.jsx("p",{className:"text-gray-600",children:s.hours})]}),s.website&&e.jsx("div",{children:e.jsxs(l,{variant:"outline",onClick:()=>window.open(s.website,"_blank"),className:"w-full",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Visit Website"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{onClick:()=>g(s.lat,s.lng,s.address),variant:"outline",className:"flex-1",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"View on Maps"]}),e.jsxs(l,{onClick:i,className:"flex-1",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Get Directions"]})]})]})]}),e.jsx(I,{store:s,className:"h-fit"})]}),e.jsxs(u,{children:[e.jsxs(j,{children:[e.jsx(w,{children:"Quick Actions"}),e.jsxs(C,{children:["Interact with ",s.name," and manage your preferences"]})]}),e.jsx(f,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsx(l,{variant:"outline",size:"sm",children:"Add to Favorites"}),e.jsx(l,{variant:"outline",size:"sm",children:"Share Store"}),e.jsx(l,{variant:"outline",size:"sm",children:"Write Review"}),e.jsx(l,{variant:"outline",size:"sm",children:"Report Issue"})]})})]}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(l,{variant:"ghost",onClick:()=>window.history.back(),children:"← Back to Stores"})})]})}):e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Store Not Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"The store you're looking for doesn't exist or has been removed."}),e.jsx(l,{onClick:()=>window.history.back(),children:"Go Back"})]})})}export{z as default};
